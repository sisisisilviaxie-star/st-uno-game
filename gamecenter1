<!-- game_center.html -->
<style>
    /* ä½ çš„æ¸¸æˆæœºæ ·å¼ */
    body { background: #222; color: white; font-family: sans-serif; padding: 20px; }
    .header { border-bottom: 1px solid #444; padding-bottom: 10px; margin-bottom: 20px; }
    .user-info { font-size: 0.9em; color: #aaa; }
</style>

<div class="game-console">
    <div class="header">
        <h2>åŒå±‚æ¸¸æˆä¸­å¿ƒ</h2>
        <!-- è¿™é‡Œç›´æ¥æ˜¾ç¤ºæ³¨å…¥çš„å˜é‡ -->
        <div class="user-info">ç©å®¶: <span id="display-name">åŠ è½½ä¸­...</span></div>
    </div>

    <div class="game-content">
        <button onclick="playDice()">ğŸ² æ·éª°å­</button>
        <div id="result-area" style="margin-top:20px;"></div>
    </div>
</div>

<script>
    // ã€å…³é”®ã€‘è¿™é‡Œä¸éœ€è¦å®šä¹‰ userNameï¼Œå› ä¸ºåŠ è½½å™¨å·²ç»æ³¨å…¥äº†ï¼
    // ç›´æ¥ä½¿ç”¨å³å¯
    
    // åˆå§‹åŒ–
    $(document).ready(function() {
        // è¿™é‡Œçš„ userName å°±æ˜¯ä»æ­£åˆ™è„šæœ¬é‡Œä¼ è¿‡æ¥çš„
        if(typeof userName !== 'undefined') {
            $('#display-name').text(userName);
        } else {
            $('#display-name').text("æœªçŸ¥ç©å®¶");
        }
    });

    // å…¨å±€çŠ¶æ€å¯¹è±¡ï¼ˆç”¨äºè¢«åŠ è½½å™¨ä¿å­˜/æ¢å¤ï¼‰
    window.gameState = {
        lastResult: null
    };

    // ä¾›åŠ è½½å™¨è°ƒç”¨çš„æ¢å¤å‡½æ•°
    window.loadGameState = function(data) {
        if(data && data.lastResult) {
            $('#result-area').text("æ¢å¤ä¸Šæ¬¡è®°å½•: " + data.lastResult);
            window.gameState = data;
        }
    };

    function playDice() {
        const point = Math.floor(Math.random() * 6) + 1;
        const text = `æ·å‡ºäº† ${point} ç‚¹`;
        
        $('#result-area').text(text);
        
        // æ›´æ–°çŠ¶æ€ä»¥ä¾¿ä¿å­˜
        window.gameState.lastResult = text;

        // å‘é€ç»™é…’é¦† (è¿›é˜¶æŠ€å·§: Slash Command)
        // æ³¨æ„ï¼šå› ä¸ºè¿™æ˜¯åŒå±‚åŠ è½½ï¼Œwindowå¯¹è±¡æ˜¯å…±äº«çš„ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨ triggerSlash
        if (window.triggerSlash) {
            // å»¶æ—¶ä¸€ç‚¹ç‚¹å‘é€ï¼Œä½“éªŒæ›´å¥½
            setTimeout(() => {
                window.triggerSlash(`/send [ç³»ç»Ÿæ¶ˆæ¯: ${userName} ${text}] | /trigger`);
            }, 500);
        }
    }
</script>
